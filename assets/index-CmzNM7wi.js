import{r as x,g as C}from"./phaser-CFjeuDV9.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const n of s)if(n.type==="childList")for(const o of n.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(s){const n={};return s.integrity&&(n.integrity=s.integrity),s.referrerPolicy&&(n.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?n.credentials="include":s.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(s){if(s.ep)return;s.ep=!0;const n=e(s);fetch(s.href,n)}})();var k=x();const p=C(k);var b=(c=>(c.TitleScene="TitleScene",c.ShapeRepairScene="ShapeRepairScene",c.BubblePopScene="BubblePopScene",c))(b||{});function g(c,t){return c=Math.ceil(c),t=Math.floor(t),Math.floor(Math.random()*(t-c+1)+c)}function y(c){return c.splice(Math.floor(Math.random()*c.length),1)[0]}const v=[15079755,3978315,16769305,4416472,16089649,9510580,4379892,15741670,12578629,16432852,4626832,14466815,10117924,16775880,8388608,11206595,8421376,16767153,117,11119017,16777215,0];function E(){let c=[];return()=>(c.length===0&&(c=[...v]),y(c))}class O extends p.Scene{constructor(){super(b.BubblePopScene)}STORAGE_KEYS={BUBBLE_COUNT_INDEX:"bubblePopScene_bubbleCountIndex",DRAG_TO_KILL_ENABLED:"bubblePopScene_dragToKillEnabled"};bubbleSize=200;TOTAL_BUBBLES=50;BUBBLE_COUNT_OPTIONS=[20,50,200,-1];bubbleCountIndex=1;REFILL_DELAY=0;dragToKillEnabled=!1;isResetting=!1;preload(){this.load.image("bubble","assets/images/bubble.png"),this.load.image("spark","assets/images/particle.png"),this.load.audio("pop","assets/audio/pop.mp3").once("filecomplete-audio-pop",t=>{console.log("pop sound loaded"),this.popSound=this.sound.add(t)}),this.load.audio("victory",["assets/audio/sparkle.mp3"]).once("filecomplete-audio-victory",()=>{console.log("victory sound loaded"),this.victorySound=this.sound.add("victory")})}create(){console.log("create bubble scene"),this.loadSettings(),this.cleanupBubbles(),this.addBackButton(),this.addProgressCounter(),this.computeSizing(),this.createBubbleGrid(),this.scale.on("resize",this.handleResize,this),this.setupDragToKill()}loadSettings(){try{const t=localStorage.getItem(this.STORAGE_KEYS.BUBBLE_COUNT_INDEX);if(t!==null){const i=parseInt(t,10);i>=0&&i<this.BUBBLE_COUNT_OPTIONS.length&&(this.bubbleCountIndex=i,this.TOTAL_BUBBLES=this.BUBBLE_COUNT_OPTIONS[this.bubbleCountIndex])}const e=localStorage.getItem(this.STORAGE_KEYS.DRAG_TO_KILL_ENABLED);e!==null&&(this.dragToKillEnabled=e==="true")}catch(t){console.warn("Failed to load settings from localStorage:",t)}}saveSettings(){try{localStorage.setItem(this.STORAGE_KEYS.BUBBLE_COUNT_INDEX,this.bubbleCountIndex.toString()),localStorage.setItem(this.STORAGE_KEYS.DRAG_TO_KILL_ENABLED,this.dragToKillEnabled.toString())}catch(t){console.warn("Failed to save settings to localStorage:",t)}}createBubbleGrid(){this.createBubbleBucket(),this.fillBubbleGrid()}createBubbleBucket(){let t=this.TOTAL_BUBBLES;if(this.TOTAL_BUBBLES===-1){const e=Math.round(this.gameWidth/this.bubbleSize),i=Math.round(this.gameHeight/this.bubbleSize);t=e*i*2}for(let e=0;e<t;e++){const i=this.createBubble(0,0);i.setVisible(!1),i.setAlpha(1),i.x=-1e3,i.y=-1e3,this.bubbleBucket.push(i)}}fillBubbleGrid(){const t=Math.round(this.gameWidth/this.bubbleSize),e=Math.round(this.gameHeight/this.bubbleSize),i=t*e,s=[],n=[];this.bubbles.forEach(a=>{const r=Math.round((a.x-this.bubbleSize/2)/this.bubbleSize),d=Math.round((a.y-this.bubbleSize/2)/this.bubbleSize);r>=0&&r<t&&d>=0&&d<e?s.push(a):n.push(a)}),n.forEach(a=>{a.setVisible(!1),a.setAlpha(1),a.x=-1e3,a.y=-1e3,this.bubbleBucket.push(a),this.bubbles.delete(a)});const o=new Set;s.forEach(a=>{const r=Math.round((a.x-this.bubbleSize/2)/this.bubbleSize),d=Math.round((a.y-this.bubbleSize/2)/this.bubbleSize);o.add(`${d},${r}`)});const l=i-s.length;let h=Math.min(l,this.bubbleBucket.length);if(this.TOTAL_BUBBLES===-1&&this.bubbleBucket.length<l){const a=l-this.bubbleBucket.length;for(let r=0;r<a;r++){const d=this.createBubble(0,0);d.setVisible(!1),d.setAlpha(1),d.x=-1e3,d.y=-1e3,this.bubbleBucket.push(d)}h=l}let f=0;for(let a=0;a<e&&f<h;a++)for(let r=0;r<t&&f<h;r++){const d=`${a},${r}`;if(!o.has(d)){const u=this.bubbleBucket.shift();u.x=r*this.bubbleSize+this.bubbleSize/2,u.y=a*this.bubbleSize+this.bubbleSize/2,u.setVisible(!0),u.setAlpha(1),this.resetBubbleInteractivity(u),this.bubbles.add(u),f++}}}handleResize(){this.repositionProgressCounter(),this.repositionButtons(),this.fillBubbleGrid()}getUIScaleFactor(){const t=Math.min(this.gameWidth,this.gameHeight);return Math.max(.7,Math.min(2,t/600))}repositionButtons(){const t=this.getUIScaleFactor();if(this.backButton){const e=Math.round(48*t),i=Math.round(20*t),s=Math.round(10*t);this.backButton.setStyle({fontSize:`${e}px`}),this.backButton.setPadding(i,0,i,s)}if(this.settingsButton){const e=Math.round(36*t),i=Math.round(15*t),s=Math.round(10*t);if(this.backButton){const n=this.backButton.getBounds(),o=n.right+Math.round(20*t)*.5,l=n.centerY;this.settingsButton.setPosition(o,l)}this.settingsButton.setStyle({fontSize:`${e}px`}),this.settingsButton.setPadding(i,s,i,s)}if(this.progressText){const e=Math.round(32*t),i=Math.round(20*t),s=Math.round(10*t);this.progressText.setStyle({fontSize:`${e}px`}),this.progressText.setPadding(i,s,i,s)}}fillSpecificSpot(t,e){if(this.isResetting)return;const i=`${t},${e}`;this.pendingRefills.has(i)||(this.bubbleBucket.length>0||this.TOTAL_BUBBLES===-1)&&(this.pendingRefills.add(i),this.time.delayedCall(this.REFILL_DELAY,()=>{if(this.isResetting){this.pendingRefills.delete(i);return}this.pendingRefills.delete(i);let s;if(this.bubbleBucket.length>0)s=this.bubbleBucket.shift();else if(this.TOTAL_BUBBLES===-1)s=this.createBubble(t,e);else return;this.isPositionEmpty(t,e)&&(this.tweens.killTweensOf(s),s.floatTween&&(s.floatTween.destroy(),s.floatTween=null),s.x=t,s.y=e,s.setVisible(!0),this.bubbles.add(s),this.resetBubbleInteractivity(s),s.setAlpha(0),this.tweens.add({targets:s,alpha:1,ease:"Cubic.easeInOut",duration:1500,onComplete:()=>{}}))}))}isPositionEmpty(t,e){for(const s of this.bubbles)if(Math.abs(s.x-t)<10&&Math.abs(s.y-e)<10)return!1;return!0}finalize(){this.victorySound?.play(),this.addPlayAgainButton()}cleanupBubbles(){this.pendingRefills.clear(),this.time.removeAllEvents(),this.settingsPanelVisible&&(this.settingsPanel?.destroy(),this.settingsBackground?.destroy(),this.settingsPanelVisible=!1),this.bubbles.forEach(t=>{this.tweens.killTweensOf(t),t.floatTween&&t.floatTween.destroy(),t.removeAllListeners(),t.destroy()}),this.bubbles.clear(),this.bubbleBucket.forEach(t=>{this.tweens.killTweensOf(t),t.floatTween&&t.floatTween.destroy(),t.removeAllListeners(),t.destroy()}),this.bubbleBucket=[],this.bubblesPopped=0,this.pendingRefills.clear(),this.particleManagers.forEach(t=>{t.destroy()}),this.particleManagers.clear()}backButton;settingsButton;progressText;progressHint;settingsPanel;settingsBackground;settingsPanelVisible=!1;popSound;victorySound;colorFactory=E();bubbleWidth=0;bubbleHeight=0;get gameWidth(){return this.scale.gameSize.width}get gameHeight(){return this.scale.gameSize.height}bubbles=new Set;particleManagers=new Set;bubbleBucket=[];bubblesPopped=0;pendingRefills=new Set;popBubble(t){if(!this.bubbles.has(t)){console.log("Attempted to pop bubble not in active set");return}this.tweens.killTweensOf(t);const e=t.x,i=t.y,s=50;var n=this.add.particles(t.x,t.y,"spark",{speed:2e3,quantity:5,gravityY:13e3,scale:{min:.05,max:.1},x:{min:-s,max:s},y:{min:-s,max:s}});this.particleManagers.add(n),this.popSound?.play(),this.bubbles.delete(t),this.bubblesPopped++,this.updateProgressCounter(),this.tweens.add({targets:t,scaleX:0,scaleY:0,ease:"Sine.easeInOut",duration:100,onComplete:()=>{t.destroy(),n.stop(),this.time.delayedCall(2e3,()=>{this.particleManagers.delete(n),n.destroy()}),this.fillSpecificSpot(e,i),this.TOTAL_BUBBLES!==-1&&this.bubblesPopped>=this.TOTAL_BUBBLES&&this.finalize()}})}createBubble(t,e){const i=this.make.sprite({key:"bubble"});return i.displayWidth=this.bubbleSize,i.displayHeight=this.bubbleSize,i.setTint(this.colorFactory()),i.setInteractive({cursor:"pointer"}),i}computeSizing(){const t=this.createBubble(0,0);this.bubbleWidth=t.displayWidth,this.bubbleHeight=t.displayHeight,t.destroy()}addBackButton(){const t=this.getUIScaleFactor(),e=Math.round(48*t),i=Math.round(20*t),s=Math.round(10*t);this.backButton=this.add.text(10,10,"←",{fontSize:`${e}px`,color:"white"}).setOrigin(0).setPadding(i,0,i,s).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",(r,d,u,S)=>{S.stopPropagation(),this.scene.restart(),this.scene.switch(b.TitleScene)}).setDepth(10).on("pointerover",()=>this.backButton.setStyle({fill:"#f39c12"})).on("pointerout",()=>this.backButton.setStyle({fill:"#FFF"}));const n=Math.round(36*t),o=Math.round(15*t),l=Math.round(10*t),h=this.backButton.getBounds(),f=h.right+i*.5,a=h.centerY;this.settingsButton=this.add.text(f,a,"⚙",{fontSize:`${n}px`,color:"white"}).setOrigin(0,.5).setPadding(o,l,o,l).setStyle({backgroundColor:"#333"}).setInteractive({useHandCursor:!0}).on("pointerdown",(r,d,u,S)=>{S.stopPropagation(),this.toggleSettingsPanel()}).setDepth(10).on("pointerover",()=>this.settingsButton.setStyle({fill:"#f39c12",backgroundColor:"#555"})).on("pointerout",()=>this.settingsButton.setStyle({fill:"#FFF",backgroundColor:"#333"}))}addPlayAgainButton(){const t=this.getUIScaleFactor(),e=Math.round(48*t),i=Math.round(50*t);var s=this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"Play Again",{fontSize:`${e}px`,color:"white"}).setOrigin(.5).setPadding(i).setResolution(10).setStyle({backgroundColor:"green"}).setInteractive({useHandCursor:!0}).on("pointerdown",(n,o,l,h)=>{h.stopPropagation(),this.cleanupBubbles(),this.scene.restart()}).setDepth(10).on("pointerover",()=>s.setStyle({fill:"#f39c12"})).on("pointerout",()=>s.setStyle({fill:"#FFF"}))}addProgressCounter(){const t=this.getUIScaleFactor(),e=Math.round(32*t),i=Math.round(20*t),s=Math.round(10*t),n=this.TOTAL_BUBBLES===-1?"Bubbles: ∞":`Bubbles: ${this.TOTAL_BUBBLES}`;this.progressText=this.add.text(this.scale.gameSize.width-10,10,n,{fontSize:`${e}px`,color:"white"}).setOrigin(1,0).setPadding(i,s,i,s).setStyle({backgroundColor:"#333"}).setDepth(10)}cycleBubbleCount(t){this.bubbleCountIndex=t,this.TOTAL_BUBBLES=this.BUBBLE_COUNT_OPTIONS[this.bubbleCountIndex],this.saveSettings();const e=this.TOTAL_BUBBLES===-1?"Bubbles: ∞":`Bubbles: ${this.TOTAL_BUBBLES}`;this.progressText.setText(e),this.resetGame()}resetGame(){this.isResetting=!0,this.cleanupBubbles(),this.bubblesPopped=0,this.bubbleBucket=[],this.time.delayedCall(50,()=>{this.createBubbleBucket(),this.fillBubbleGrid(),this.updateProgressCounter(),this.isResetting=!1})}updateProgressCounter(){if(this.TOTAL_BUBBLES===-1)this.progressText.setText(`Bubbles: ${this.bubblesPopped} popped`);else{const t=this.TOTAL_BUBBLES-this.bubblesPopped;this.progressText.setText(`Bubbles: ${t}`)}}resetBubbleInteractivity(t){const e=t.x,i=t.y;this.tweens.killTweensOf(t),t.floatTween&&(t.floatTween.destroy(),t.floatTween=null),t.x=e,t.y=i,t.removeAllListeners(),t.setInteractive({cursor:"pointer"}),this.dragToKillEnabled||t.on("pointerdown",()=>{this.settingsPanelVisible||this.bubbles.has(t)&&this.popBubble(t)});const s=this.tweens.add({targets:t,props:{x:{value:`+=${g(1,10)}`,duration:g(1e3,1500),delay:g(1,1e3),ease:"Sine.easeInOut"},y:{value:`+=${g(1,10)}`,duration:g(2e3,2500),delay:g(1,1e3),ease:"Sine.easeInOut"},scaleX:{value:`+=.0${g(1,3)}`,duration:g(2e3,3e3),delay:g(1,1e3),ease:"Sine.easeInOut"},scaleY:{value:`+=.0${g(1,3)}`,duration:g(1e3,2e3),delay:g(1,1e3),ease:"Sine.easeInOut"}},repeat:-1,yoyo:!0});t.floatTween=s}repositionProgressCounter(){this.progressText&&this.progressText.setPosition(this.scale.gameSize.width-10,10),this.progressHint&&this.progressHint.setPosition(this.scale.gameSize.width-10,60)}setupDragToKill(){let t=!1,e=null;this.input.on("pointerdown",i=>{if(this.dragToKillEnabled&&!this.settingsPanelVisible){t=!0,e=null;const s=this.getBubbleAtPosition(i.x,i.y);s&&(this.popBubble(s),e=s)}}),this.input.on("pointerup",()=>{t=!1,e=null}),this.input.on("pointermove",i=>{if(this.dragToKillEnabled&&t&&!this.settingsPanelVisible){const s=this.getBubbleAtPosition(i.x,i.y);s&&s!==e&&(this.popBubble(s),e=s)}})}getBubbleAtPosition(t,e){for(const i of this.bubbles)if(i.getBounds().contains(t,e))return i;return null}toggleSettingsPanel(){this.settingsPanelVisible?this.hideSettingsPanel():this.showSettingsPanel()}showSettingsPanel(){if(this.settingsPanelVisible)return;this.settingsBackground=this.add.rectangle(this.cameras.main.centerX,this.cameras.main.centerY,this.gameWidth,this.gameHeight,0,.7).setDepth(20).setInteractive(),this.settingsPanel=this.add.container(this.cameras.main.centerX,this.cameras.main.centerY),this.settingsPanel.setDepth(21);const t=this.add.rectangle(0,0,450,450,3355443);t.setStrokeStyle(2,5592405);const e=this.add.text(0,-190,"Settings",{fontSize:"32px",color:"white",fontStyle:"bold"}).setOrigin(.5),i=this.add.text(195,-190,"×",{fontSize:"36px",color:"white"}).setOrigin(.5).setPadding(10,5,10,5).setStyle({backgroundColor:"#666"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>this.hideSettingsPanel()).on("pointerover",()=>i.setStyle({fill:"#f39c12",backgroundColor:"#888"})).on("pointerout",()=>i.setStyle({fill:"#FFF",backgroundColor:"#666"})),s=this.add.text(0,-130,"Bubble Count:",{fontSize:"20px",color:"white",fontStyle:"bold"}).setOrigin(.5),n=[],o=["20","50","200","∞"];o.forEach((a,r)=>{const d=-90+r*25,u=this.bubbleCountIndex===r,S=this.add.circle(-100,d,8,u?65280:6710886);S.setStrokeStyle(2,16777215);const P=this.add.text(-80,d,a,{fontSize:"18px",color:u?"#00ff00":"white"}).setOrigin(0,.5);n.push({radio:S,label:P})});const l=this.add.text(-150,50,"Drag Mode:",{fontSize:"20px",color:"white"}).setOrigin(0,.5),h=this.add.text(50,50,this.dragToKillEnabled?"ON":"OFF",{fontSize:"20px",color:"white"}).setOrigin(.5).setPadding(20,8,20,8).setStyle({backgroundColor:this.dragToKillEnabled?"#006600":"#666"}).setInteractive({useHandCursor:!0}).on("pointerdown",(a,r,d,u)=>{u.stopPropagation(),this.dragToKillEnabled=!this.dragToKillEnabled,h.setText(this.dragToKillEnabled?"ON":"OFF"),h.setStyle({backgroundColor:this.dragToKillEnabled?"#006600":"#666"}),this.saveSettings(),this.time.delayedCall(10,()=>{this.bubbles.forEach(S=>{this.resetBubbleInteractivity(S)})})}).on("pointerover",()=>h.setStyle({fill:"#f39c12"})).on("pointerout",()=>h.setStyle({fill:"#FFF"})),f=this.add.text(0,90,`When enabled, drag to pop bubbles
instead of clicking`,{fontSize:"14px",color:"#ccc",align:"center"}).setOrigin(.5);this.settingsPanel.add([t,e,i,s,l,h,f]),n.forEach(a=>{this.settingsPanel.add([a.radio,a.label])}),o.forEach((a,r)=>{const d=-90+r*25;this.add.rectangle(this.cameras.main.centerX-50,this.cameras.main.centerY+d,200,25,0,0).setInteractive({useHandCursor:!0}).on("pointerdown",(u,S,P,T)=>{T.stopPropagation(),n.forEach((B,w)=>{w===r?(B.radio.setFillStyle(65280),B.label.setColor("#00ff00")):(B.radio.setFillStyle(6710886),B.label.setColor("white"))}),this.cycleBubbleCount(r),this.time.delayedCall(300,()=>this.hideSettingsPanel())}).on("pointerover",()=>{this.bubbleCountIndex!==r&&n[r].label.setColor("#f39c12")}).on("pointerout",()=>{this.bubbleCountIndex!==r&&n[r].label.setColor("white")}).setDepth(22)}),this.settingsPanel.setAlpha(0),this.settingsPanel.setScale(.8),this.tweens.add({targets:this.settingsPanel,alpha:1,scaleX:1,scaleY:1,duration:200,ease:"Back.easeOut"}),this.settingsPanelVisible=!0,this.settingsBackground.on("pointerdown",()=>this.hideSettingsPanel())}hideSettingsPanel(){this.settingsPanelVisible&&this.tweens.add({targets:this.settingsPanel,alpha:0,scaleX:.8,scaleY:.8,duration:150,ease:"Back.easeIn",onComplete:()=>{this.settingsPanel?.destroy(),this.settingsBackground?.destroy(),this.settingsPanelVisible=!1}})}}class z extends p.Scene{constructor(){super(b.ShapeRepairScene)}quadrantColumnCount=2;quadrantRowCount=3;resetPositionSpeed=4500;preload(){console.log("preload shape scene"),this.load.audio("whoosh",["assets/audio/whoosh.mp3"]).once("filecomplete-audio-whoosh",()=>{console.log("whoosh sound loaded"),this.whooshSound=this.sound.add("whoosh")}),this.load.audio("victory",["assets/audio/sparkle.mp3"]).once("filecomplete-audio-victory",()=>{console.log("victory sound loaded"),this.victorySound=this.sound.add("victory")})}create(){console.log("create shape scene"),this.reset(),this.addBackButton(),this.calculateQuadrants(this.quadrantColumnCount,this.quadrantRowCount),this.drawQuadrants();const t=[...this.quadrants],e=[...this.distinctColors];for(;t.length>0;){const s=y(t),n=y(t);s&&n&&(this.createShapePair(e.shift(),s,n),this.pairsRemaining++)}this.input.on("drag",function(s,n,o,l){n.x=o,n.y=l});const i=new Map;this.input.on("dragstart",(s,n,o,l)=>{n.depth=1,i.set(n,{x:n.x,y:n.y})}),this.input.on("dragend",(s,n,o,l)=>{n.depth=0;const h=n.getBounds(),a=this.shapePairMap.get(n)?.getBounds();if(p.Geom.Intersects.RectangleToRectangle(h,a))this.finalizePair(n);else{const r=i.get(n);r&&(this.movements.push({sprite:n,destination:r}),this.physics.moveTo(n,r.x,r.y,this.resetPositionSpeed))}i.delete(n)})}distinctColors=[15079755,3978315,16769305,4416472,16089649,9510580,4379892,15741670,12578629,16432852,4626832,14466815,10117924,16775880,8388608,11206595,8421376,16767153,117,11119017,16777215,0];quadrants=[];pairsRemaining=0;shapePairMap=new Map;backButton;whooshSound;victorySound;addBackButton(){this.backButton=this.add.text(10,10,"←",{fontSize:"48px",color:"white"}).setOrigin(0).setPadding(20,0,20,10).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.create(),this.scene.restart(),this.scene.switch(b.TitleScene)}).setDepth(10).on("pointerover",()=>this.backButton.setStyle({fill:"#f39c12"})).on("pointerout",()=>this.backButton.setStyle({fill:"#FFF"}))}addPlayAgainButton(){this.add.text(this.cameras.main.centerX,this.cameras.main.centerY,"Play Again",{fontSize:"48px",color:"white"}).setOrigin(.5).setPadding(50).setResolution(10).setStyle({backgroundColor:"green"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.restart()}).setDepth(10).on("pointerover",()=>this.backButton.setStyle({fill:"#f39c12"})).on("pointerout",()=>this.backButton.setStyle({fill:"#FFF"}))}finishRound(){this.victorySound?.play(),this.addPlayAgainButton()}reset(){this.quadrants=[],this.pairsRemaining=0;for(const[t]of this.shapePairMap)t.destroy();this.shapePairMap=new Map,this.input.removeAllListeners();for(const t of this.children.list)t.destroy();this.backButton?.destroy()}finalizePair(t){const e=this.shapePairMap.get(t);t.disableInteractive(),e?.disableInteractive(),t.x=e.x,t.y=e.y,this.pairsRemaining--;const i=this.tweens.createTimeline();this.whooshSound?.play(),i.add({targets:[t,e],duration:50,yoyo:!0,scaleX:1.2,scaleY:1.2}).add({targets:[t,e],duration:50,scaleX:.001,scaleY:.001}).once("complete",()=>{t.destroy(),e.destroy(),this.pairsRemaining<=0&&this.finishRound()}).play()}movements=[];update(t,e){this.processMovements()}processMovements(){for(let t=this.movements.length-1;t>=0;t--){const e=this.movements[t],i=this.resetPositionSpeed*1.5/this.game.loop.targetFps,s=p.Math.Distance.BetweenPoints(e.sprite,e.destination);e.sprite.body.speed>0&&s<i&&(e.sprite.body.reset(e.destination.x,e.destination.y),this.movements.splice(t,1))}}calculateQuadrants(t,e){let i=this.scale.gameSize.width;const s=i/t,n=this.scale.gameSize.height,o=n/e;for(let l=0;l<n;l+=o)for(let h=0;h<i;h+=s){const f={x:h,y:l,centerX:h+s/2,centerY:l+o/2,width:s,height:o};this.quadrants.push(f)}}drawQuadrants(){for(const t of this.quadrants){const e=this.add.graphics();e.strokeRect(t.x,t.y,t.width,t.height),e.stroke()}}makeDraggable(t){t.setInteractive(this.input.makePixelPerfect()),this.input.setDraggable(t)}createShapePair(t,e,i){const s=g(30,120),n=Math.min(e.width,e.height)/2.1,o=this.createCirclePart(t,n,0,s);this.makeDraggable(o),o.x=e.centerX,o.y=e.centerY;const l=this.createCirclePart(t,n,s,360);this.makeDraggable(l),l.x=i.centerX,l.y=i.centerY,this.shapePairMap.set(o,l),this.shapePairMap.set(l,o)}createCirclePart(t,e,i,s){var n=this.make.graphics({x:0,y:0,add:!1});n.fillStyle(t,1),n.lineStyle(3,0,1),n.beginPath(),n.arc(e,e,e,p.Math.DegToRad(s),p.Math.DegToRad(i),!0),n.lineTo(e,e),n.fillPath(),n.strokePath(),n.arc(e,e,e,p.Math.DegToRad(s),p.Math.DegToRad(i),!0),n.strokePath();const o="texture"+this.textureIndex++;return n.generateTexture(o,e*2,e*2),n.destroy(),this.physics.add.sprite(e,e,o)}textureIndex=0}class L extends p.Scene{buildTimestamp;constructor(){super(b.TitleScene)}preload(){this.load.image("bubble-tile","assets/images/bubble-tile.png"),this.load.image("shape-tile","assets/images/shape-tile.png")}create(){const t=new URLSearchParams(window.location.search).get("game");t&&this.scene.switch(t),this.add.image(this.cameras.main.centerX-250,this.cameras.main.centerY,"bubble-tile").setDisplaySize(300,300).setInteractive().on("pointerdown",()=>{this.scene.switch(b.BubblePopScene)});const e=this.add.text(this.cameras.main.centerX-250,this.cameras.main.centerY,"Bubble Popper",{fontSize:"35px",color:"white"}).setOrigin(.5).setResolution(10).setPadding(5).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.switch(b.BubblePopScene)}).on("pointerover",()=>e.setStyle({fill:"#f39c12"})).on("pointerout",()=>e.setStyle({fill:"#FFF"}));this.add.image(this.cameras.main.centerX+250,this.cameras.main.centerY,"shape-tile").setDisplaySize(300,300).setInteractive().on("pointerdown",()=>{this.scene.switch(b.ShapeRepairScene)});const i=this.add.text(this.cameras.main.centerX+250,this.cameras.main.centerY,"Shapes",{fontSize:"35px",color:"white"}).setOrigin(.5).setResolution(10).setPadding(75,5,75,5).setStyle({backgroundColor:"#111"}).setInteractive({useHandCursor:!0}).on("pointerdown",()=>{this.scene.switch(b.ShapeRepairScene)}).on("pointerover",()=>i.setStyle({fill:"#f39c12"})).on("pointerout",()=>i.setStyle({fill:"#FFF"}));this.buildTimestamp=this.add.text(this.cameras.main.width-10,this.cameras.main.height-10,"Build: 2025-06-30 20:43",{fontSize:"12px",color:"#FFFFFF",fontFamily:"monospace"}).setOrigin(1,1).setDepth(100),this.scale.on("resize",this.handleResize,this)}handleResize(){this.buildTimestamp&&this.buildTimestamp.setPosition(this.cameras.main.width-10,this.cameras.main.height-10)}update(t,e){}}const m=new p.Game({type:p.AUTO,parent:"game",backgroundColor:"#33A5E7",scale:{width:800,height:600,mode:p.Scale.RESIZE,autoCenter:p.Scale.CENTER_BOTH},physics:{default:"arcade"}});m.scene.add(b.TitleScene,L);m.scene.add(b.ShapeRepairScene,z);m.scene.add(b.BubblePopScene,O);m.scene.start(b.TitleScene);
